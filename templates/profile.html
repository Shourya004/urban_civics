{% extends "base.html" %}

{% block content %}
    <div class="page profile-page active" id="profile">
        <div class="container">
            <div class="profile-container">
                <div class="profile-header">
                    <div class="profile-avatar">ðŸ‘¤</div>
                    <h2>{{ session.name }}</h2>
                    <p>Citizen Account</p>
                    <button class="btn btn-secondary" onclick="openEditProfile()" style="margin-top: 16px; ">Edit Profile</button>
                </div>

                <div class="profile-info">
                    <div class="info-group">
                        <div class="info-item">
                            <label>Full Name</label>
                            <p>{{ session.name }}</p>
                        </div>
                        <div class="info-item">
                            <label>Account Status</label>
                            <p style="color: var(--success);">âœ“ Active</p>
                        </div>
                    </div>
                    <div class="info-group">
                        <div class="info-item">
                            <label>Phone Number</label>
                            <p>{{ session.phone }}</p>
                        </div>
<!--                        <div class="info-item">-->
<!--                            <label>Account Status</label>-->
<!--                            <p style="color: var(&#45;&#45;success);">âœ“ Active</p>-->
<!--                        </div>-->
                    </div>
                    <div class="info-group">
                        <div class="info-item">
                            <label>Email Address</label>
                            <p>{{ session.email }}</p>
                        </div>
<!--                        <div class="info-item">-->
<!--                            <label>Complaints Filed</label>-->
<!--                            <p>24 total</p>-->
<!--                        </div>-->
                    </div>
                    <div class="info-group">
<!--                        <div class="info-item">-->
<!--                            <label>Member Since</label>-->
<!--                            <p>January 15, 2025</p>-->
<!--                        </div>-->
                        <div class="info-item">
                            <label>Complaints Filed</label>
                            <p>{{ complaints }} total</p>
                        </div>
                    </div>
                </div>

                <div style="margin-top: 30px; text-align: center; display: flex; gap: 12px; justify-content: center;">
                    <button class="btn btn-secondary" onclick="openChangePassword()">Change Password</button>
                    <button class="btn btn-secondary" onclick="openEmailUpdate()">Change Email</button>
                    <button class="btn btn-secondary" onclick="openDeleteModal()">Delete Account</button>
                </div>
            </div>
        </div>
    </div>

<div class="modal" id="editProfileModal">
    <div class="modal-content">
        <button class="modal-close" onclick="closeEditProfile()">âœ•</button>
        <h3>Edit Profile</h3>

        <form method="POST" action="{{ url_for('update_profile') }}">
            <div class="form-group">
                <label>Full Name</label>
                <input type="text" name="name" value="{{ session.name }}" required>
            </div>

            <div class="form-group">
                <label>Phone Number</label>
                <input type="text" name="phone" value="{{ session.phone }}" required>
            </div>

            <div style="margin-top: 20px;">
                <button type="submit" class="btn btn-primary">Save Changes</button>
            </div>
        </form>
    </div>
</div>

<div class="modal" id="changePasswordModal">
    <div class="modal-content">
        <button class="modal-close" onclick="closeChangePassword()">âœ•</button>
        <h3>Change Password</h3>

        <form method="POST" action="{{ url_for('change_password') }}">
            <div class="form-group">
                <input type="password" name="current_password" placeholder="Current Password" required>
            </div>
            <div class="form-group">
                <input type="password" name="new_password" placeholder="New Password" required>
            </div>
            <button type="submit" class="btn btn-primary">Update Password</button>
        </form>
    </div>
</div>

<div class="modal" id="updateEmailModal">
    <div class="modal-content">
        <button class="modal-close" onclick="closeEmailUpdate()">âœ•</button>
        <h3>Update Email Address</h3>

        <form method="POST" action="{{ url_for('request_email_change') }}">
            <div class="form-group">
                <input type="email" name="email" placeholder="Enter new email address" required>
            </div>
            <button type="submit" class="btn btn-primary">
                Send Verification Link
            </button>
        </form>
    </div>
</div>

<div class="modal" id="deleteModal" style="display:none;">
    <div class="modal-content">

        <h3 style="color:red;">âš  Delete Account</h3>
        <p>This action is permanent and cannot be undone.</p>

        <form method="POST" action="{{ url_for('delete_account') }}">
            <button type="submit" class="btn btn-danger" style="margin-top: 20px;">
                Yes, Delete My Account
            </button>
        </form>

        <button style="margin-top: 20px;" class="btn" onclick="closeDeleteModal()">
            Cancel
        </button>

    </div>
</div>
{% endblock %}